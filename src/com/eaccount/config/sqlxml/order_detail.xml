<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Order_detail">

    <resultMap type="com.eaccount.domain.Order_detail" id="Order_detailResult">
        <!-- Order_detailè¡¨ -->
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="order_id" jdbcType="INTEGER" property="order_id"/>
        <result column="product_id" jdbcType="INTEGER" property="product_id"/>
        <result column="unit_price" jdbcType="INTEGER" property="unit_price"/>
        <result column="quantity_delivery" jdbcType="INTEGER" property="quantity_delivery"/>
        <result column="quantity_receiving" jdbcType="INTEGER" property="quantity_receiving"/>
        <result column="product_name" jdbcType="VARCHAR" property="product_name"/>
        <result column="product_specification" jdbcType="VARCHAR" property="product_specification"/>
        <result column="money" jdbcType="INTEGER" property="money"/>
    </resultMap>

    <select id="SelectOrderDetailInfoByOrderId" parameterType="com.eaccount.domain.Order_detail" resultMap="Order_detailResult">
        SELECT a.order_id, a.product_id, a.unit_price, a.quantity_delivery, a.quantity_receiving, b.product_name, b.product_specification, COUNT(a.quantity_receiving * a.unit_price) AS money
        FROM table_order_detail a, table_product b WHERE 1 = 1
        AND a.order_id = #{order_id}
        AND a.product_id = b.id
        GROUP BY a.product_id
    </select>

    <select id="SelectOrderDetailInfoByMatterOrderId" parameterType="com.eaccount.domain.Order_detail" resultMap="Order_detailResult">
        SELECT a.order_id, a.product_id, a.unit_price, a.quantity_delivery, a.quantity_receiving, b.product_name, b.product_specification, COUNT(a.quantity_receiving * a.unit_price) AS money
        FROM table_order_detail a, table_product b WHERE 1 = 1
        AND a.order_id = #{order_id}
        AND a.product_id = b.id
        AND a.quantity_delivery != a.quantity_receiving
        GROUP BY a.product_id
    </select>
</mapper>